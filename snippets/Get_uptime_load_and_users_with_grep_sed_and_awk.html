
    <!DOCTYPE html>
    <html lang="en">
        <head>
        <title>Correctly Grep And Display The Uptime, Load Average And Amount Of Users - Raymii.org</title>
        <link href="/s/inc/css/bootstrap.css" rel="stylesheet" />
        <link href="/s/inc/js/google-code-prettify/prettify.css" rel="stylesheet" />
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    </head>
    <body>
        <a id="top-of-page"></a>
        <div class="container-fluid ">
        <div class="row-fluid">
        
        <div class="span10 offset1">
                
            <div class="span4 well"> 
            
                <h1 class="topheader">Raymii.org</h1>
                <h6>Quis custodiet ipsos custodes?</h6>
                <h6><a href="/s/feed.xml">RSS</a></h6>
            
            </div>

            <div class="span4 green-block">
                
                    <h3>Featured Items</h3>
    <a href="/s/tutorials/Ansible.html" class="whitelink">Ansible</a>
<br />
<a href="/s/tutorials/Autossh_persistent_tunnels.html" class="whitelink">Autossh persistent tunnels</a>
<br />
<a href="/s/software/Codename_Geld.html" class="whitelink">Codename Geld</a>
<br />
<a href="/s/tutorials/Munin_optimalization_on_Debian.html" class="whitelink">Munin optimalization on Debian</a>
<br />
<a href="/s/articles/Small_Linux_PCs.html" class="whitelink">Small Linux PCs</a>
<br />

            
        </div>
        <div class="span4 green-block">
            
                <h3>Featured Items</h3>
    <a href="/s/software/Bash_PHP_Server_Status_Monitor.html" class="whitelink">Bash PHP Server Status Monitor</a>
<br />
<a href="/s/articles/Encryption-on-ANY-cloud-service.html" class="whitelink">Encryption on ANY cloud service</a>
<br />
<a href="/s/tutorials/IPSEC_L2TP_vpn_with_Ubuntu_12.04.html" class="whitelink">IPSEC L2TP vpn with Ubuntu 12.04</a>
<br />
<a href="/s/software/NutsManager.html" class="whitelink">NutsManager</a>
<br />
<a href="/s/tutorials/Tahoe_LAFS_Storage_Grid.html" class="whitelink">Tahoe LAFS Storage Grid</a>
<br />

            
        </div>
    </div>
    
    </div>
    <div class="row-fluid">
    <div class="span10 offset1">
    

    <div class="span3">
    <h3>Menu</h3><ul class="nav nav-pills nav-stacked">
<li><a href="/s/" class="link">Home</a>
</li>
<li><a href="/s/static/Disclaimer.html" class="link">Disclaimer</a>
</li>
<li><a href="/s/static/Terrible-Linux.html" class="link">Terrible Linux</a>
</li>
</ul>
<h3>Categories</h3>
<ul class="nav nav-pills nav-stacked">
<li><a href="/s/articles" class="link">Articles</a>
</li>
<li><a href="/s/snippets" class="link">Snippets</a>
</li>
<li><a href="/s/software" class="link">Software</a>
</li>
<li><a href="/s/tutorials" class="link">Tutorials</a>
</li>
</ul></div>  <div class="span7">   <div class="inner"><h2>Correctly grep and display the uptime, load average and amount of users</h2>
<ul class="breadcrumb">
<li><a href="../" class="link">Home</a>
<span class="divider">/</span></li>
<li><a href="../snippets" class="link">Snippets</a>
<span class="divider">/</span></li>
<li><a href="Get_uptime_load_and_users_with_grep_sed_and_awk.html" class="link">Correctly grep and display the uptime, load average and amount of users</a>
</li>
</ul>
<h6>Author: Remy Van Elst</h6>
<h6>Date: 06-09-2012</h6>
<br></br>
<p>While doing my monitoring script <a href="https://raymii.org/cms/p_">ray-mon</a> I found out it can be quite hard to get the correct values for uptime, load average and users on different systems. </p>

<p>For example, the <em>uptime</em> command displays this on a mac:</p>

<pre><code> 8:27  up 1 day, 17:06, 1 user, load averages: 1,01 0,87 0,79
</code></pre>

<p>This on a debian 6 machine:</p>

<pre><code> 06:27:33 up 4 days,  2:36,  2 users,  load average: 0.16, 0.26, 0.27
</code></pre>

<p>This on a RHEL 5 machine:</p>

<pre><code> 06:28:26 up 54 min,  127 users,  load average: 6.34, 6.28, 6.27
</code></pre>

<p>Small differences in space placement, "load averages:" instead of "load average:" and "min" vs "days". It took me quite a while to find out how to get the correct values for the following items using just unix tools:</p>

<ul>
<li>Uptime</li>
<li>Amount of users logged in</li>
<li>Current load average</li>
</ul>

<h4>Uptime</h4>

<pre><code>uptime | grep -ohe 'up .*' | sed 's/,//g' | awk '{ print $2" "$3 }'
</code></pre>

<p>First take the output of uptime to grep, only show matching characters (-oh) and do regex (-e). Filter on "up" "space" "everything after that". Then go to sed to remove the comma's "4 days," to "4 days", and then with awk print the second and third collumn, and remove the rest of the output.</p>

<h4>Users logged in</h4>

<pre><code>uptime | grep -ohe '[0-9.*] user[s,]'
</code></pre>

<p>Take the output of uptime to grep, only show matching characters (-oh), and do regex (-e). Filter on "number between 0 and 9" "any amount of the previous character" "space" "user, or users"</p>

<h4>Load</h4>

<pre><code>uptime | grep -ohe 'load average[s:][: ].*' | awk '{ print $3 }'
</code></pre>

<p>First take the output of uptime to grep. only show matching characters (-oh), and do regex (-e). Filter on "load average: or load averages:" "eerything after that". The with awk print the 3d collumn.</p>
<hr></hr>
Tags: <a href="../tags/awk.html" class="link">awk, 
</a>
<a href="../tags/bash.html" class="link">bash, 
</a>
<a href="../tags/grep.html" class="link">grep, 
</a>
<a href="../tags/load.html" class="link">load, 
</a>
<a href="../tags/uptime.html" class="link">uptime, 
</a>
<a href="../tags/users.html" class="link">users, 
</a>
<div class="footer">
                <hr>

                <p>Generated by <a href="https://raymii.org/s/software/ingsoc.html">ingsoc</a>.<br />

                <small>954a2a21e88800276a6de3c7a89ead</small></p>

                <small><a href="http://validator.w3.org/check/referer" target="_blank">Validate XHTML</a></small>

                </div>
            </div>
        </div>
    </div>  
    </div>
    </div>    
    </body>
    </html>
    